grammar ViewDSL {

  ViewFile = "views" "{" ImportStmt* ThemeDef? ViewDef* "}";

  ImportStmt = "include" Name ";";

  ThemeDef = "theme" "{" ThemeSetting* "}";
  ThemeSetting = "font" "=" STRING ";"
               | "color" "=" STRING ";"
               | "accent" "=" STRING ";";

  ViewDef = "View" Name ViewAttrs? StateDef? "{" Component* "}";

  ViewAttrs = "attributes" "{" ViewAttr* "}";
  ViewAttr = "title" "=" STRING ";"
           | "route" "=" STRING ";"
           | "layout" "=" STRING ";";

  StateDef = "state" "{" StateVar* "}";
  StateVar = Name ":" TypeName ("=" DefaultExpr)? ";";
  DefaultExpr = STRING | NUMBER | BOOLEAN;

  Component = VStack | HStack | Text | TextField | Button | Image | NavigationLink | HtmlElement | HtmlVoid | IncludeView;

  VStack = "VStack" "{" Component* "}";
  HStack = "HStack" "{" Component* "}";
  Text = "Text" "(" STRING ")";

  TextField = "TextField" "(" "name:" Name "," "placeholder:" STRING ")";

  Button = "Button" "(" STRING ")" ActionBlock;
  ActionBlock = "{" "action" "=" STRING ";"? "}";

  Image = "Image" "(" "src:" STRING "," "alt:" STRING ")";

  NavigationLink = "NavigationLink" "(" "label:" STRING "," "target:" Name ")";

  HtmlElement = "Html" TagName HtmlAttrs? HtmlContent? "end";
  HtmlVoid = "HtmlSelfClosing" TagName HtmlAttrs? ";";

  IncludeView = "include" Name ";";

  TagName = /[a-z][a-z0-9]*/;
  HtmlAttrs = "attributes" "{" HtmlAttr* "}";
  HtmlAttr = Name "=" STRING ";";
  HtmlContent = "content" "=" STRING ";";

  Name = /[a-zA-Z_][a-zA-Z0-9_]*/;
  TypeName = /[A-Z][a-zA-Z0-9_]*/;
  STRING = /"[^"\\]*(\\.[^"\\]*)*"/;
  NUMBER = /[0-9]+/;
  BOOLEAN = "true" | "false";

}
